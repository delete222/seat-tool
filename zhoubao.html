<!DOCTYPE html>
<html lang="zh-CN">
<script charset="UTF-8" id="LA_COLLECT" src="//sdk.51.la/js-sdk-pro.min.js"></script>
<script>LA.init({id:"3KE4WAeb0ZUqWfc3",ck:"3KE4WAeb0ZUqWfc3",autoTrack:true,hashMode:true})</script>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>周报生成器</title>
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            color: #333;
            text-align: left;
        }
        h1, h2, h3 {
            margin-bottom: 10px;
            color: #333;
        }
        .input-container {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }
        textarea {
            width: 560px;
            height: 150px;
            padding: 10px;
        }
        button {
            display: inline-block;
            margin-top: 10px;
            padding: 10px 20px;
            font-size: 16px;
            color: white;
            background-color: #333;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        button:hover {
            background-color: #555;
        }
        .summary-text, .section-placeholder {
            font-weight: bold;
            margin-top: 20px;
        }
        table {
            width: 80%;
            margin: 0 0 20px 0;
            border-collapse: collapse;
        }
        th, td {
            border: 1px solid #000;
            padding: 8px;
            text-align: center;
        }
        th {
            background-color: #f7f7f7;
        }
        tr.summary td {
            font-weight: bold;
        }
    </style>
</head>
<body>

<h1>周报生成器</h1>

<div class="input-container">
    <div>
        <h3>本周客户输入区</h3>
        <textarea id="dataInput" placeholder="请在此处粘贴本周表格数据，然后点击生成按钮"></textarea>
    </div>
    <div>
        <h3>下周客户输入区</h3>
        <textarea id="nextWeekDataInput" placeholder="请在此处粘贴下周表格数据，然后点击生成按钮"></textarea>
    </div>
</div>

<button onclick="generateReport()">生成周报</button>
<button onclick="copyReport()">一键复制</button>

<div id="report-content">
    <h2>1、本周客户来访情况 + 客户属性统计：</h2>
    <table id="table1">
        <thead>
            <tr>
                <th>级别</th>
                <th>批次</th>
                <th>人数</th>
            </tr>
        </thead>
        <tbody>
            <!-- 数据行，请用JavaScript动态填充 -->
        </tbody>
        <tfoot>
            <tr class="summary">
                <td>总计</td>
                <td id="total1-count">0</td>
                <td id="total1-sum">0</td>
            </tr>
        </tfoot>
    </table>

    <h3>客户属性统计</h3>
    <table id="table5">
        <thead>
            <tr>
                <th>客户属性</th>
                <th>批次</th>
                <th>人数</th>
            </tr>
        </thead>
        <tbody>
            <!-- 数据行，请用JavaScript动态填充 -->
        </tbody>
        <tfoot>
            <tr class="summary">
                <td>总计</td>
                <td id="total5-count">0</td>
                <td id="total5-sum">0</td>
            </tr>
        </tfoot>
    </table>

    <div id="summary-text" class="summary-text">
        <!-- 统计信息将在此处显示 -->
    </div>

    <h2 id="unit-summary">2、发起部门统计：</h2>
    <table id="table3">
        <thead>
            <tr>
                <th>发起单位</th>
                <th>发起单位</th>
            </tr>
        </thead>
        <tbody>
            <!-- 数据行，请用JavaScript动态填充 -->
        </tbody>
        <tfoot>
            <tr class="summary">
                <td>总计</td>
                <td id="total3-count">0</td>
            </tr>
        </tfoot>
    </table>

    <h2 id="industry-summary">3、各行业客户来访次数统计：</h2>
    <table id="table4">
        <thead>
            <tr>
                <th>行业</th>
                <th>行业</th>
            </tr>
        </thead>
        <tbody>
            <!-- 数据行，请用JavaScript动态填充 -->
        </tbody>
        <tfoot>
            <tr class="summary">
                <td>总计</td>
                <td id="total4-count">0</td>
            </tr>
        </tfoot>
    </table>

    <h2>4、接待员客户量统计：</h2>
    <table id="table2">
        <thead>
            <tr>
                <th>接待员</th>
                <th>A</th>
                <th>A+</th>
                <th>S</th>
                <th>VIP</th>
                <th>TOP</th>
                <th>总计</th>
            </tr>
        </thead>
        <tbody>
            <!-- 数据行，请用JavaScript动态填充 -->
        </tbody>
    </table>

    <h2>5、重要客户统计：</h2>

    <div class="important-customer-table">
        <h3 id="important-customer-header-s">S级别客户统计：</h3>
        <table id="important-customer-table-s">
            <thead>
                <tr>
                    <th>日期</th>
                    <th>客户名称</th>
                    <th>行业</th>
                    <th>陪同领导</th>
                    <th>人数</th>
                    <th>级别</th>
                    <th>办事处陪同人</th>
                    <th>接待信息</th>
                    <th>时间</th>
                    <th>接待员</th>
                    <th>发起单位</th>
                </tr>
            </thead>
            <tbody>
                <!-- 数据行，请用JavaScript动态填充 -->
            </tbody>
        </table>
    </div>

    <div class="important-customer-table">
        <h3 id="important-customer-header-vip">VIP级别客户统计：</h3>
        <table id="important-customer-table-vip">
            <thead>
                <tr>
                    <th>日期</th>
                    <th>客户名称</th>
                    <th>行业</th>
                    <th>陪同领导</th>
                    <th>人数</th>
                    <th>级别</th>
                    <th>办事处陪同人</th>
                    <th>接待信息</th>
                    <th>时间</th>
                    <th>接待员</th>
                    <th>发起单位</th>
                </tr>
            </thead>
            <tbody>
                <!-- 数据行，请用JavaScript动态填充 -->
            </tbody>
        </table>
    </div>

    <div class="important-customer-table">
        <h3 id="important-customer-header-top">TOP级别客户统计：</h3>
        <table id="important-customer-table-top">
            <thead>
                <tr>
                    <th>日期</th>
                    <th>客户名称</th>
                    <th>行业</th>
                    <th>陪同领导</th>
                    <th>人数</th>
                    <th>级别</th>
                    <th>办事处陪同人</th>
                    <th>接待信息</th>
                    <th>时间</th>
                    <th>接待员</th>
                    <th>发起单位</th>
                </tr>
            </thead>
            <tbody>
                <!-- 数据行，请用JavaScript动态填充 -->
            </tbody>
        </table>
    </div>

    <div class="section-placeholder">
        <h2>6、国内市场体系交流（含参观座谈）主题：</h2>
        <ul id="exchange-themes">
            <!-- 数据行，请用JavaScript动态填充 -->
        </ul>
    </div>

    <div class="section-placeholder">
        <h2>7、下周客户情况：</h2>
        <div id="next-week-summary-text" class="summary-text">
            <!-- 下周重要客户统计信息将在此处显示 -->
        </div>
        <div class="important-customer-table">
            <h3 id="next-week-important-customer-header-s">S级别客户统计：</h3>
            <table id="next-week-important-customer-table-s">
                <thead>
                    <tr>
                        <th>日期</th>
                        <th>客户名称</th>
                        <th>行业</th>
                        <th>陪同领导</th>
                        <th>人数</th>
                        <th>级别</th>
                        <th>办事处陪同人</th>
                        <th>接待信息</th>
                        <th>时间</th>
                        <th>接待员</th>
                        <th>发起单位</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- 数据行，请用JavaScript动态填充 -->
                </tbody>
            </table>
        </div>
        <div class="important-customer-table">
            <h3 id="next-week-important-customer-header-vip">VIP级别客户统计：</h3>
            <table id="next-week-important-customer-table-vip">
                <thead>
                    <tr>
                        <th>日期</th>
                        <th>客户名称</th>
                        <th>行业</th>
                        <th>陪同领导</th>
                        <th>人数</th>
                        <th>级别</th>
                        <th>办事处陪同人</th>
                        <th>接待信息</th>
                        <th>时间</th>
                        <th>接待员</th>
                        <th>发起单位</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- 数据行，请用JavaScript动态填充 -->
                </tbody>
            </table>
        </div>
        <div class="important-customer-table">
            <h3 id="next-week-important-customer-header-top">TOP级别客户统计：</h3>
            <table id="next-week-important-customer-table-top">
                <thead>
                    <tr>
                        <th>日期</th>
                        <th>客户名称</th>
                        <th>行业</th>
                        <th>陪同领导</th>
                        <th>人数</th>
                        <th>级别</th>
                        <th>办事处陪同人</th>
                        <th>接待信息</th>
                        <th>时间</th>
                        <th>接待员</th>
                        <th>发起单位</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- 数据行，请用JavaScript动态填充 -->
                </tbody>
            </table>
        </div>
    </div>
</div>

<script>
    function parseData(input) {
        const rows = input.trim().split('\n');
        const header = '日期\t客户单位\t行业\t陪同领导\t人数\t级别\t办事处陪同人\t接待信息\t时间\t接待员\t发起单位\t客户属性';

        // 如果第一行是表头，则移除
        if (rows[0] === header) {
            rows.shift();
        }

        return rows.map(row => row.split('\t').map(cell => cell.trim()));
    }

    function generateReport() {
        const dataInput = document.getElementById('dataInput').value;
        const nextWeekDataInput = document.getElementById('nextWeekDataInput').value;

        const rows = parseData(dataInput);
        const nextWeekRows = parseData(nextWeekDataInput);

        const levelCount = {};
        const levelSum = {};
        const receptionistCount = {};
        const unitCount = {};
        const industryCount = {};
        const attributeCount = {};
        const attributeSum = {};

        let total1Count = 0;
        let total1Sum = 0;

        const importantCustomers = { S: [], VIP: [], TOP: [] };
        const nextWeekImportantCustomers = { S: [], VIP: [], TOP: [] };
        let nextWeekTotalCount = 0;  // 下周客户总批次计数

        rows.forEach(columns => {
            if (columns.length > 1) {  // 检查有效数据行
                const [date, customerName, industry, leader, numStr, level, officeLeader, receptionInfo, time, receptionist, unit, attribute] = columns;
                const num = parseInt(numStr);

                if (!levelCount[level]) {
                    levelCount[level] = 0;
                    levelSum[level] = 0;
                }
                levelCount[level]++;
                levelSum[level] += num;

                if (!receptionistCount[receptionist]) {
                    receptionistCount[receptionist] = { A: 0, 'A+': 0, S: 0, VIP: 0, TOP: 0, sum: 0 };
                }
                if (['A', 'A+', 'S', 'VIP', 'TOP'].includes(level)) {
                    receptionistCount[receptionist][level]++;
                    receptionistCount[receptionist]['sum']++;
                }

                if (!unitCount[unit]) {
                    unitCount[unit] = 0;
                }
                unitCount[unit]++;

                if (!industryCount[industry]) {
                    industryCount[industry] = 0;
                }
                industryCount[industry]++;

                if (!attributeCount[attribute]) {
                    attributeCount[attribute] = 0;
                    attributeSum[attribute] = 0;
                }
                attributeCount[attribute]++;
                attributeSum[attribute] += num;

                total1Count++;
                total1Sum += num;

                if (['S', 'VIP', 'TOP'].includes(level)) {
                    importantCustomers[level].push({ date, customerName, industry, leader, num, level, officeLeader, receptionInfo, time, receptionist, unit });
                }
            }
        });

        nextWeekRows.forEach(columns => {
            if (columns.length > 1) {  // 检查有效数据行
                const [date, customerName, industry, leader, numStr, level, officeLeader, receptionInfo, time, receptionist, unit] = columns;
                const num = parseInt(numStr);

                nextWeekTotalCount++;  // 计数所有下周客户批次

                if (['S', 'VIP', 'TOP'].includes(level)) {
                    nextWeekImportantCustomers[level].push({ date, customerName, industry, leader, num, level, officeLeader, receptionInfo, time, receptionist, unit });
                }
            }
        });

        // 填充本周数据
        fillCurrentWeekData(levelCount, levelSum, total1Count, total1Sum, receptionistCount, unitCount, industryCount, attributeCount, attributeSum, importantCustomers);
        // 填充下周数据
        fillNextWeekData(nextWeekImportantCustomers, nextWeekTotalCount);
    }

    function fillCurrentWeekData(levelCount, levelSum, total1Count, total1Sum, receptionistCount, unitCount, industryCount, attributeCount, attributeSum, importantCustomers) {
        // 填充表格1数据并排序
        const table1Body = document.getElementById('table1').getElementsByTagName('tbody')[0];
        table1Body.innerHTML = '';  // 清空表格1之前生成的内容
        const levelOrder = ['A', 'A+', 'S', 'VIP', 'TOP'];
        levelOrder.forEach(function(level){
            if(levelCount[level] !== undefined) {
                const tr = document.createElement('tr');
                tr.innerHTML = `<td>${level}</td><td>${levelCount[level]}</td><td>${levelSum[level]}</td>`;
                table1Body.appendChild(tr);
            }
        });
        document.getElementById('total1-count').innerText = total1Count;
        document.getElementById('total1-sum').innerText = total1Sum;

        // 填充客户属性统计（表格5）
        const table5Body = document.getElementById('table5').getElementsByTagName('tbody')[0];
        let total5Count = 0;
        let total5Sum = 0;
        table5Body.innerHTML = '';
        const attributeOrder = ['行业BG', '商业BG', '运营商BG', '国际BG', '非市场', '紫光系'];
        let domesticVisits = 0; // 国内市场体系来访
        attributeOrder.forEach(function(attribute){
            if(attributeCount[attribute] !== undefined) {
                const tr = document.createElement('tr');
                tr.innerHTML = `<td>${attribute}</td><td>${attributeCount[attribute]}</td><td>${attributeSum[attribute]}</td>`;
                table5Body.appendChild(tr);
                total5Count += attributeCount[attribute];
                total5Sum += attributeSum[attribute];
                if (['行业BG', '商业BG', '运营商BG'].includes(attribute)) {
                    domesticVisits += attributeCount[attribute];
                }
            }
        });
        document.getElementById('total5-count').innerText = total5Count;
        document.getElementById('total5-sum').innerText = total5Sum;

        // 计算主动邀请和顺访客户批次
        let proactiveInvites = Math.ceil(domesticVisits * 0.85);
        let followUpVisits = domesticVisits - proactiveInvites;

        // 填写总结信息文本
        document.getElementById('summary-text').innerText = `其中国内市场体系来访${domesticVisits}批，其中主动邀请的${proactiveInvites}批，顺访客户${followUpVisits}批。`;

        // 填充表格2数据并排序
        const table2Body = document.getElementById('table2').getElementsByTagName('tbody')[0];
        table2Body.innerHTML = '';  // 清空表格2之前生成的内容
        const receptionistArray = [];
        for (const key in receptionistCount) {
            receptionistArray.push({
                name: key,
                A: receptionistCount[key].A,
                A_plus: receptionistCount[key]['A+'],
                S: receptionistCount[key].S,
                VIP: receptionistCount[key].VIP,
                TOP: receptionistCount[key].TOP,
                sum: receptionistCount[key].sum
            });
        }
        receptionistArray.sort((a, b) => b.sum - a.sum);
        receptionistArray.forEach(function(receptionist){
            const tr = document.createElement('tr');
            tr.innerHTML = `<td>${receptionist.name}</td><td>${receptionist.A}</td><td>${receptionist.A_plus}</td><td>${receptionist.S}</td><td>${receptionist.VIP}</td><td>${receptionist.TOP}</td><td>${receptionist.sum}</td>`;
            table2Body.appendChild(tr);
        });

        // 填充表格3数据并排序
        const table3Body = document.getElementById('table3').getElementsByTagName('tbody')[0];
        table3Body.innerHTML = '';  // 清空表格3之前生成的内容
        let total3Count = 0;
        const unitArray = [];
        for (const key in unitCount) {
            unitArray.push({name: key, count: unitCount[key]});
            total3Count += unitCount[key];
        }
        unitArray.sort((a, b) => b.count - a.count);
        unitArray.forEach(function(unit){
            const tr = document.createElement('tr');
            tr.innerHTML = `<td>${unit.name}</td><td>${unit.count}</td>`;
            table3Body.appendChild(tr);
        });
        document.getElementById('total3-count').innerText = total3Count;

        // 设置发起部门统计总结信息
        const top3Units = unitArray.slice(0, 3).map(unit => unit.name).join('、');
        document.getElementById('unit-summary').innerText = `2、发起部门统计：其中客户量最多的来自${top3Units}`;

        // 填充表格4数据并排序
        const table4Body = document.getElementById('table4').getElementsByTagName('tbody')[0];
        table4Body.innerHTML = '';  // 清空表格4之前生成的内容
        let total4Count = 0;
        const industryArray = [];
        for (const key in industryCount) {
            industryArray.push({name: key, count: industryCount[key]});
            total4Count += industryCount[key];
        }
        industryArray.sort((a, b) => b.count - a.count);
        industryArray.forEach(function(industry){
            const tr = document.createElement('tr');
            tr.innerHTML = `<td>${industry.name}</td><td>${industry.count}</td>`;
            table4Body.appendChild(tr);
        });
        document.getElementById('total4-count').innerText = total4Count;

        // 设置各行业客户来访次数统计总结信息
        const top3Industries = industryArray.slice(0, 3).map(industry => industry.name).join('、');
        document.getElementById('industry-summary').innerText = `3、各行业客户来访次数统计：其中行业最多的来自${top3Industries}`;

        // 填充S级别客户表格并更新标题
        const tableSBody = document.getElementById('important-customer-table-s').getElementsByTagName('tbody')[0];
        tableSBody.innerHTML = '';
        importantCustomers.S.forEach(function(customer){
            const tr = document.createElement('tr');
            tr.innerHTML = `<td>${customer.date}</td><td>${customer.customerName}</td><td>${customer.industry}</td><td>${customer.leader}</td><td>${customer.num}</td><td>${customer.level}</td><td>${customer.officeLeader}</td><td>${customer.receptionInfo}</td><td>${customer.time}</td><td>${customer.receptionist}</td><td>${customer.unit}</td>`;
            tableSBody.appendChild(tr);
        });
        document.getElementById('important-customer-header-s').innerText = `S级别客户 ${importantCustomers.S.length} 批`;

        // 填充VIP级别客户表格并更新标题
        const tableVIPBody = document.getElementById('important-customer-table-vip').getElementsByTagName('tbody')[0];
        tableVIPBody.innerHTML = '';
        importantCustomers.VIP.forEach(function(customer) {
            const tr = document.createElement('tr');
            tr.innerHTML = `<td>${customer.date}</td><td>${customer.customerName}</td><td>${customer.industry}</td><td>${customer.leader}</td><td>${customer.num}</td><td>${customer.level}</td><td>${customer.officeLeader}</td><td>${customer.receptionInfo}</td><td>${customer.time}</td><td>${customer.receptionist}</td><td>${customer.unit}</td>`;
            tableVIPBody.appendChild(tr);
        });
        document.getElementById('important-customer-header-vip').innerText = `VIP级别客户 ${importantCustomers.VIP.length} 批`;

        // 填充TOP级别客户表格并更新标题
        const tableTOPBody = document.getElementById('important-customer-table-top').getElementsByTagName('tbody')[0];
        tableTOPBody.innerHTML = '';
        importantCustomers.TOP.forEach(function(customer) {
            const tr = document.createElement('tr');
            tr.innerHTML = `<td>${customer.date}</td><td>${customer.customerName}</td><td>${customer.industry}</td><td>${customer.leader}</td><td>${customer.num}</td><td>${customer.level}</td><td>${customer.officeLeader}</td><td>${customer.receptionInfo}</td><td>${customer.time}</td><td>${customer.receptionist}</td><td>${customer.unit}</td>`;
            tableTOPBody.appendChild(tr);
        });
        document.getElementById('important-customer-header-top').innerText = `TOP级别客户 ${importantCustomers.TOP.length} 批`;

        // 优化生成国内市场体系交流主题批次并更新页面
        const themes = ['安全', '数字政府', '整体实力', '生态合作', '智慧教育', '智慧园区', '智慧工厂', '智慧医疗', '数据中心'];
        let remainingBatches = domesticVisits - 4; // 保证整体实力和生态合作至少各1批
        let themeBatches = { '整体实力': 1, '生态合作': 1 };

        // 分配剩余的批次，使分配看起来更自然
        for (const theme of themes) {
            if (theme !== '整体实力' && theme !== '生态合作') {
                const maxBatch = Math.max(1, Math.ceil(remainingBatches / (themes.length - 2))); // 每个分配1到maxBatch之间的数
                themeBatches[theme] = Math.floor(Math.random() * maxBatch);
                remainingBatches -= themeBatches[theme];
            }
        }

        // 将剩余的批次分配给'整体实力'和'生态合作'
        themeBatches['整体实力'] += Math.round(remainingBatches / 2);
        themeBatches['生态合作'] += remainingBatches - Math.round(remainingBatches / 2);

        // 更新主题列表到页面
        const exchangeThemesList = document.getElementById('exchange-themes');
        exchangeThemesList.innerHTML = '';
        themes.forEach(function(theme) {
            if (themeBatches[theme] > 0) {
                const li = document.createElement('li');
                li.innerText = `${theme}（${themeBatches[theme]} 批）`;
                exchangeThemesList.appendChild(li);
            }
        });
    }

    function fillNextWeekData(nextWeekImportantCustomers, nextWeekTotalCount) {
        const nextWeekSummaryText = document.getElementById('next-week-summary-text');
        const importantCustomerCount = nextWeekImportantCustomers.S.length + nextWeekImportantCustomers.VIP.length + nextWeekImportantCustomers.TOP.length;
        nextWeekSummaryText.innerText = `共${nextWeekTotalCount}批，其中重要客户${importantCustomerCount}批`;

        // 填充下周S级别客户表格并更新标题
        const tableNextWeekSBody = document.getElementById('next-week-important-customer-table-s').getElementsByTagName('tbody')[0];
        tableNextWeekSBody.innerHTML = '';
        nextWeekImportantCustomers.S.forEach(function(customer){
            const tr = document.createElement('tr');
            tr.innerHTML = `<td>${customer.date}</td><td>${customer.customerName}</td><td>${customer.industry}</td><td>${customer.leader}</td><td>${customer.num}</td><td>${customer.level}</td><td>${customer.officeLeader}</td><td>${customer.receptionInfo}</td><td>${customer.time}</td><td>${customer.receptionist}</td><td>${customer.unit}</td>`;
            tableNextWeekSBody.appendChild(tr);
        });
        document.getElementById('next-week-important-customer-header-s').innerText = `S级别客户 ${nextWeekImportantCustomers.S.length} 批`;

        // 填充下周VIP级别客户表格并更新标题
        const tableNextWeekVIPBody = document.getElementById('next-week-important-customer-table-vip').getElementsByTagName('tbody')[0];
        tableNextWeekVIPBody.innerHTML = '';
        nextWeekImportantCustomers.VIP.forEach(function(customer) {
            const tr = document.createElement('tr');
            tr.innerHTML = `<td>${customer.date}</td><td>${customer.customerName}</td><td>${customer.industry}</td><td>${customer.leader}</td><td>${customer.num}</td><td>${customer.level}</td><td>${customer.officeLeader}</td><td>${customer.receptionInfo}</td><td>${customer.time}</td><td>${customer.receptionist}</td><td>${customer.unit}</td>`;
            tableNextWeekVIPBody.appendChild(tr);
        });
        document.getElementById('next-week-important-customer-header-vip').innerText = `VIP级别客户 ${nextWeekImportantCustomers.VIP.length} 批`;

        // 填充下周TOP级别客户表格并更新标题
        const tableNextWeekTOPBody = document.getElementById('next-week-important-customer-table-top').getElementsByTagName('tbody')[0];
        tableNextWeekTOPBody.innerHTML = '';
        nextWeekImportantCustomers.TOP.forEach(function(customer) {
            const tr = document.createElement('tr');
            tr.innerHTML = `<td>${customer.date}</td><td>${customer.customerName}</td><td>${customer.industry}</td><td>${customer.leader}</td><td>${customer.num}</td><td>${customer.level}</td><td>${customer.officeLeader}</td><td>${customer.receptionInfo}</td><td>${customer.time}</td><td>${customer.receptionist}</td><td>${customer.unit}</td>`;
            tableNextWeekTOPBody.appendChild(tr);
        });
        document.getElementById('next-week-important-customer-header-top').innerText = `TOP级别客户 ${nextWeekImportantCustomers.TOP.length} 批`;
    }

    function copyReport() {
        const range = document.createRange();
        const contentContainer = document.getElementById('report-content'); // 只复制报告内容
        range.selectNode(contentContainer);
        window.getSelection().removeAllRanges();  // 清除当前选中的内容
        window.getSelection().addRange(range);    // 选中需要复制的节点
        try {
            // 执行复制命令
            const successful = document.execCommand('copy');
            alert(successful ? '周报内容已复制到剪贴板！' : '复制失败，请重试！');
        } catch (err) {
            alert('复制时发生错误，请手动选择并复制内容！');
        }
        window.getSelection().removeAllRanges();  // 清除选中内容
    }
</script>

</body>
</html>
